import 'package:flutter/material.dart';



// Classe que representa um estudante, com todos os seus atributos.
class Estudante {
  String nome;
  int idade;
  String curso;
  double matricula;
  double mediaAluno;
  String tipo;

  Estudante(this.nome, this.idade, this.curso,
      {required this.matricula, required this.mediaAluno, required this.tipo});
}



// O ponto de entrada do aplicativo Flutter.
void main() {
  runApp(const MyApp());
}

// Widget principal que define a estrutura básica do aplicativo.
class MyApp extends StatelessWidget {
  const MyApp({Key? key}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Gerenciamento de Estudantes',
      theme: ThemeData(
        primarySwatch: Colors.indigo,
        visualDensity: VisualDensity.adaptivePlatformDensity,
        fontFamily: 'Inter',
      ),
      home: const StudentListPage(),
    );
  }
}

// Um widget estático para exibir um cabeçalho.

class StudentListHeader extends StatelessWidget {
  const StudentListHeader({Key? key}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return const Padding(
      padding: EdgeInsets.fromLTRB(16, 24, 16, 8),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          Text(
            'Catálogo de Estudantes',
            style: TextStyle(
              fontSize: 24,
              fontWeight: FontWeight.bold,
              color: Colors.black87,
            ),
          ),
          SizedBox(height: 4),
          Text(
            'Use os campos abaixo para filtrar os resultados.',
            style: TextStyle(
              fontSize: 16,
              color: Colors.black54,
            ),
          ),
        ],
      ),
    );
  }
}

// Widget de estado para gerenciar a lista de estudantes e o estado de filtro.
class StudentListPage extends StatefulWidget {
  const StudentListPage({Key? key}) : super(key: key);

  @override
  _StudentListPageState createState() => _StudentListPageState();
}

class _StudentListPageState extends State<StudentListPage> {
  // Lista de todos os estudantes.
  final List<Estudante> todosEstudantes = [
    Estudante("Ana", 25, "Engenharia", matricula: 26793, mediaAluno: 8.5, tipo: "a+"),
    Estudante("Bruno", 22, "Medicina", matricula: 34567, mediaAluno: 7.8, tipo: "a+"),
    Estudante("Carla", 30, "Direito", matricula: 78045, mediaAluno: 9.3, tipo: "b+"),
    Estudante("Daniel", 31, "Arquitetura", matricula: 45678, mediaAluno: 6.9, tipo: "ab-"),
    Estudante("Terezinha", 23, "Psicologia", matricula: 56789, mediaAluno: 8.2, tipo: "a-"),
    Estudante("Felipe", 19, "Engenharia", matricula: 67890, mediaAluno: 6.7, tipo: "b-"),
    Estudante("Gabriel", 22, "Psicologia", matricula: 78901, mediaAluno: 7.5, tipo: "o+"),
    Estudante("Helho", 24, "Medicina", matricula: 89012, mediaAluno: 9.0, tipo: "b-"),
    Estudante("Isabela", 21, "Educação Física", matricula: 10927, mediaAluno: 8.3, tipo: "a+"),
    Estudante("João", 26, "Nutricionista", matricula: 11234, mediaAluno: 6.4, tipo: "b+"),
    Estudante("Ricardo", 33, "Agronomia", matricula: 30308, mediaAluno: 9.1, tipo: "o+"),
    Estudante("Marina", 19, "Design Gráfico", matricula: 67890, mediaAluno: 7.9, tipo: "a-"),
  ];

  List<Estudante> estudantesFiltrados = [];
  final TextEditingController minIdadeController = TextEditingController();
  final TextEditingController maxIdadeController = TextEditingController();
  final TextEditingController minMediaController = TextEditingController();
  final TextEditingController maxMediaController = TextEditingController();

  @override
  void initState() {
    super.initState();
    estudantesFiltrados = todosEstudantes;
    // Adiciona listeners para atualizar a lista em tempo real.
    minIdadeController.addListener(_aplicarFiltros);
    maxIdadeController.addListener(_aplicarFiltros);
    minMediaController.addListener(_aplicarFiltros);
    maxMediaController.addListener(_aplicarFiltros);
  }

  @override
  void dispose() {
    minIdadeController.dispose();
    maxIdadeController.dispose();
    minMediaController.dispose();
    maxMediaController.dispose();
    super.dispose();
  }

  // Função para aplicar os filtros de idade e média simultaneamente.
  void _aplicarFiltros() {
    setState(() {
      estudantesFiltrados = todosEstudantes.where((estudante) {
        final double? minIdade = double.tryParse(minIdadeController.text);
        final double? maxIdade = double.tryParse(maxIdadeController.text);
        final double? minMedia = double.tryParse(minMediaController.text);
        final double? maxMedia = double.tryParse(maxMediaController.text);

        final bool atendeIdade = (minIdade == null || estudante.idade >= minIdade) &&
            (maxIdade == null || estudante.idade <= maxIdade);

        final bool atendeMedia = (minMedia == null || estudante.mediaAluno >= minMedia) &&
            (maxMedia == null || estudante.mediaAluno <= maxMedia);

        return atendeIdade && atendeMedia;
      }).toList();
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: Colors.grey[200],
      appBar: AppBar(
        title: const Text('Gerenciamento de Estudantes'),
        centerTitle: true,
      ),
      
      body: Column(
        children: [
          const StudentListHeader(),
          Padding(
            padding: const EdgeInsets.symmetric(horizontal: 16.0),
            child: Row(
              children: [
                Expanded(
                  child: TextField(
                    controller: minIdadeController,
                    keyboardType: TextInputType.number,
                    decoration: const InputDecoration(
                      contentPadding: EdgeInsets.symmetric(vertical: 20.0),
                      labelText: 'Idade Mínima',
                      border: OutlineInputBorder(
                        borderRadius: BorderRadius.all(Radius.circular(12)),
                      ),
                    ),
                  ),
                ),
                const SizedBox(width: 10),
                Expanded(
                  child: TextField(
                    controller: maxIdadeController,
                    keyboardType: TextInputType.number,
                    decoration: const InputDecoration(
                      contentPadding: EdgeInsets.symmetric(vertical: 20.0),
                      labelText: 'Idade Máxima',
                      border: OutlineInputBorder(
                        borderRadius: BorderRadius.all(Radius.circular(12)),
                      ),
                    ),
                  ),
                ),
              ],
            ),
          ),
          Padding(
            padding: const EdgeInsets.all(16.0),
            child: Row(
              children: [
                Expanded(
                  child: TextField(
                    controller: minMediaController,
                    keyboardType: TextInputType.number,
                    decoration: const InputDecoration(
                      contentPadding: EdgeInsets.symmetric(vertical: 20.0),
                      labelText: 'Média Mínima',
                      border: OutlineInputBorder(
                        borderRadius: BorderRadius.all(Radius.circular(12)),
                      ),
                    ),
                  ),
                ),
                const SizedBox(width: 10),
                Expanded(
                  child: TextField(
                    controller: maxMediaController,
                    keyboardType: TextInputType.number,
                    decoration: const InputDecoration(
                      contentPadding: EdgeInsets.symmetric(vertical: 20.0),
                      labelText: 'Média Máxima',
                      border: OutlineInputBorder(
                        borderRadius: BorderRadius.all(Radius.circular(12)),
                      ),
                    ),
                  ),
                ),
              ],
            ),
          ),
          const SizedBox(height: 16),
          // Usando ListView.builder para exibir a lista de estudantes.
          Expanded(
            child: ListView.builder(
              itemCount: estudantesFiltrados.length,
              itemBuilder: (context, index) {
                final estudante = estudantesFiltrados[index];
                return Card(
                  elevation: 4,
                  margin: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),
                  shape: RoundedRectangleBorder(
                    borderRadius: BorderRadius.circular(12),
                  ),
                  child: ListTile(
                    contentPadding: const EdgeInsets.all(16),
                    leading: CircleAvatar(
                      backgroundColor: Colors.red.shade200,
                      child: Text(
                        estudante.nome[0],
                        style: const TextStyle(fontWeight: FontWeight.bold, color: Colors.white),
                      ),
                    ),
                    title: Text(
                      estudante.nome,
                      style: const TextStyle(fontWeight: FontWeight.bold),
                    ),
                    subtitle: Text(
                      'Idade: ${estudante.idade} | Curso: ${estudante.curso}\nMédia: ${estudante.mediaAluno} | Tipo: ${estudante.tipo.toUpperCase()}\nMatrícula: ${estudante.matricula.toInt()}',
                    ),
                    trailing: const Icon(Icons.square, color: Colors.red),
                  ),
                );
              },
            ),
          ),
        ],
      ),
    );
  }
}
